<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Cooperative Anchor: C:/Users/pestourb/Documents/GitHub/SecureLoc/DecaWino/Deployment/Projects/Anchor_c/src/cpp/anchor_c.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Cooperative Anchor
   </div>
   <div id="projectbrief">DecaWino firmware for cooperative anchors</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d522931ffa1371640980b621734a4381.html">Users</a></li><li class="navelem"><a class="el" href="dir_df1a92ec3b43adc6b2c3e4428e80d3a8.html">pestourb</a></li><li class="navelem"><a class="el" href="dir_1ba8aa070ca6f3d8eae8cdc5396fa0cf.html">Documents</a></li><li class="navelem"><a class="el" href="dir_431e09cb7b37cebbd8d0eed6157311a8.html">GitHub</a></li><li class="navelem"><a class="el" href="dir_d02a181de93544e932e377cd0eecdd32.html">SecureLoc</a></li><li class="navelem"><a class="el" href="dir_7aa56f78274832cd0950654d783dbaa8.html">DecaWino</a></li><li class="navelem"><a class="el" href="dir_4cb6106d5d9f49de7aadf8dc5c8a3c35.html">Deployment</a></li><li class="navelem"><a class="el" href="dir_974cfa7edc9a9bb1e0ae31b428274fa8.html">Projects</a></li><li class="navelem"><a class="el" href="dir_ea8d59257cf0fed9d2f764de2e780f9c.html">Anchor_c</a></li><li class="navelem"><a class="el" href="dir_ffe2019e67a44649533bcece88413cdc.html">src</a></li><li class="navelem"><a class="el" href="dir_f49ac5166554f28530103923b24a74b3.html">cpp</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">anchor_c.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Source file for the cooperative anchor firmware. This firmware is intended for DecaWino chips. Anchors are fixed stations performing ranging with mobile tags. The cooperative anchor firmware allow an anchor to design a tag to participate in a verification process. See the platform documentation for details.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="anchor__c_8h_source.html">anchor_c.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structcontrol__frame.html">control_frame</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a1aae65bfb986e31a55fb2c0d110cd9cf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="anchor__c_8cpp.html#a1aae65bfb986e31a55fb2c0d110cd9cf">getID</a> ()</td></tr>
<tr class="memdesc:a1aae65bfb986e31a55fb2c0d110cd9cf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the anchor ID from header file configuration in default mode.  <a href="#a1aae65bfb986e31a55fb2c0d110cd9cf">More...</a><br /></td></tr>
<tr class="separator:a1aae65bfb986e31a55fb2c0d110cd9cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4d2cf5dabb492e0fd9e61db5569ed0e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="anchor__c_8cpp.html#ac4d2cf5dabb492e0fd9e61db5569ed0e">getID</a> (byte id)</td></tr>
<tr class="memdesc:ac4d2cf5dabb492e0fd9e61db5569ed0e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Attributes an ID to the anchor.  <a href="#ac4d2cf5dabb492e0fd9e61db5569ed0e">More...</a><br /></td></tr>
<tr class="separator:ac4d2cf5dabb492e0fd9e61db5569ed0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44620c59e3eba142cc41cb7cc8183cc4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="anchor__c_8cpp.html#a44620c59e3eba142cc41cb7cc8183cc4">print_byte_array</a> (byte b[8])</td></tr>
<tr class="memdesc:a44620c59e3eba142cc41cb7cc8183cc4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Displays an 8-bytes array on the serial port.  <a href="#a44620c59e3eba142cc41cb7cc8183cc4">More...</a><br /></td></tr>
<tr class="separator:a44620c59e3eba142cc41cb7cc8183cc4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acae09739fa483c0b1b6b8ceb064846dc"><td class="memItemLeft" align="right" valign="top"><a id="acae09739fa483c0b1b6b8ceb064846dc"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>get_next_target_idx</b> (byte tag_ID[8])</td></tr>
<tr class="separator:acae09739fa483c0b1b6b8ceb064846dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4aad4b6f80cf0ef4be418d7318e91a44"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="anchor__c_8cpp.html#a4aad4b6f80cf0ef4be418d7318e91a44">byte_array_cmp</a> (byte b1[8], byte b2[8])</td></tr>
<tr class="memdesc:a4aad4b6f80cf0ef4be418d7318e91a44"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks if two 8-bytes array are equal.  <a href="#a4aad4b6f80cf0ef4be418d7318e91a44">More...</a><br /></td></tr>
<tr class="separator:a4aad4b6f80cf0ef4be418d7318e91a44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a229865cac3d89d939060fc2a0a46fc92"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="anchor__c_8cpp.html#a229865cac3d89d939060fc2a0a46fc92">anchor_setup</a> ()</td></tr>
<tr class="memdesc:a229865cac3d89d939060fc2a0a46fc92"><td class="mdescLeft">&#160;</td><td class="mdescRight">DecaWino setup for anchor mode.  <a href="#a229865cac3d89d939060fc2a0a46fc92">More...</a><br /></td></tr>
<tr class="separator:a229865cac3d89d939060fc2a0a46fc92"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac10c0d7c63ddb78c74ce6b942778aeb0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="anchor__c_8cpp.html#ac10c0d7c63ddb78c74ce6b942778aeb0">anchor_RxTxConfig</a> ()</td></tr>
<tr class="memdesc:ac10c0d7c63ddb78c74ce6b942778aeb0"><td class="mdescLeft">&#160;</td><td class="mdescRight">RX/TX setup for DW1000 in anchor mode. Sets the channel, preamble length, preamble code and PRF.  <a href="#ac10c0d7c63ddb78c74ce6b942778aeb0">More...</a><br /></td></tr>
<tr class="separator:ac10c0d7c63ddb78c74ce6b942778aeb0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b20c779e29c5b89547defddfab8bd7b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="anchor__c_8cpp.html#a1b20c779e29c5b89547defddfab8bd7b">anchor_loop</a> ()</td></tr>
<tr class="memdesc:a1b20c779e29c5b89547defddfab8bd7b"><td class="mdescLeft">&#160;</td><td class="mdescRight">One iteration of the main FSM loop for TWR, with default ID parameters in header file.  <a href="#a1b20c779e29c5b89547defddfab8bd7b">More...</a><br /></td></tr>
<tr class="separator:a1b20c779e29c5b89547defddfab8bd7b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5cae2d846207eb429d7ed0f84b4439c7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="anchor__c_8cpp.html#a5cae2d846207eb429d7ed0f84b4439c7">anchor_loop</a> (byte *myID, byte *myNextAnchorID)</td></tr>
<tr class="memdesc:a5cae2d846207eb429d7ed0f84b4439c7"><td class="mdescLeft">&#160;</td><td class="mdescRight">One iteration of the main FSM loop for TWR.  <a href="#a5cae2d846207eb429d7ed0f84b4439c7">More...</a><br /></td></tr>
<tr class="separator:a5cae2d846207eb429d7ed0f84b4439c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Source file for the cooperative anchor firmware. This firmware is intended for DecaWino chips. Anchors are fixed stations performing ranging with mobile tags. The cooperative anchor firmware allow an anchor to design a tag to participate in a verification process. See the platform documentation for details. </p>
<p>This is the main file to use to program a DecaWino as a cooperative anchor. This firmware is intended for DecaWino chips. Anchors are fixed stations performing ranging with mobile tags. The cooperative anchor firmware allow an anchor to design a tag to participate in a verification process. See the platform documentation for details.</p>
<dl class="section author"><dt>Author</dt><dd>Baptiste Pestourie </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2019 December 1st </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a href="https://github.com/Hedwyn/SecureLoc">https://github.com/Hedwyn/SecureLoc</a> </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a1b20c779e29c5b89547defddfab8bd7b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1b20c779e29c5b89547defddfab8bd7b">&#9670;&nbsp;</a></span>anchor_loop() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int anchor_loop </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>One iteration of the main FSM loop for TWR, with default ID parameters in header file. </p>
<dl class="section author"><dt>Author</dt><dd>Baptiste Pestourie </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2019 December 1st </dd></dl>
<dl class="section return"><dt>Returns</dt><dd>TWR state (/!\ different from the FSM state)) </dd></dl>

</div>
</div>
<a id="a5cae2d846207eb429d7ed0f84b4439c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5cae2d846207eb429d7ed0f84b4439c7">&#9670;&nbsp;</a></span>anchor_loop() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int anchor_loop </td>
          <td>(</td>
          <td class="paramtype">byte *&#160;</td>
          <td class="paramname"><em>myID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *&#160;</td>
          <td class="paramname"><em>myNextAnchorID</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>One iteration of the main FSM loop for TWR. </p>
<dl class="section author"><dt>Author</dt><dd>Baptiste Pestourie </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2019 December 1st </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">myID</td><td>anchor ID to use </td></tr>
    <tr><td class="paramname">myNextAnchorID</td><td>ID of the following anchor </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>TWR state (/!\ different from the FSM state)) </dd></dl>
<p>Starting state of the FSM. CHecks for timeouts and restart a TWR cycle for the Master anchor. For the others, skip directly to IDLE state <br />
<br />
<br />
<br />
<br />
<br />
 Checks for serial commands, otherwise proceeds to start the ranging process <br />
<br />
<br />
<br />
<br />
 Sending a ranging request (START frame) to the target tag <br />
<br />
<br />
<br />
 Waiting for the reply (Acknowledgment frame) of the target device <br />
<br />
<br />
 Waiting for the timestamps (DATA frame) of the target device <br />
<br />
 Extracting timestamps from DATA frame and calculating the distance <br />
 Sends the Ranging results along with PHY data to the host RPI on serial port </p>

</div>
</div>
<a id="ac10c0d7c63ddb78c74ce6b942778aeb0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac10c0d7c63ddb78c74ce6b942778aeb0">&#9670;&nbsp;</a></span>anchor_RxTxConfig()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void anchor_RxTxConfig </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>RX/TX setup for DW1000 in anchor mode. Sets the channel, preamble length, preamble code and PRF. </p>
<dl class="section author"><dt>Author</dt><dd>Baptiste Pestourie </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2019 December 1st </dd></dl>

</div>
</div>
<a id="a229865cac3d89d939060fc2a0a46fc92"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a229865cac3d89d939060fc2a0a46fc92">&#9670;&nbsp;</a></span>anchor_setup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void anchor_setup </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>DecaWino setup for anchor mode. </p>
<dl class="section author"><dt>Author</dt><dd>Baptiste Pestourie </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2019 December 1st </dd></dl>

</div>
</div>
<a id="a4aad4b6f80cf0ef4be418d7318e91a44"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4aad4b6f80cf0ef4be418d7318e91a44">&#9670;&nbsp;</a></span>byte_array_cmp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int byte_array_cmp </td>
          <td>(</td>
          <td class="paramtype">byte&#160;</td>
          <td class="paramname"><em>b1</em>[8], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte&#160;</td>
          <td class="paramname"><em>b2</em>[8]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Checks if two 8-bytes array are equal. </p>
<dl class="section author"><dt>Author</dt><dd>Baptiste Pestourie </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2019 December 1st </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">8-bytes</td><td>array (ID format) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True if all the elements in both arrays are equal </dd></dl>

</div>
</div>
<a id="a1aae65bfb986e31a55fb2c0d110cd9cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1aae65bfb986e31a55fb2c0d110cd9cf">&#9670;&nbsp;</a></span>getID() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void getID </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets the anchor ID from header file configuration in default mode. </p>
<dl class="section author"><dt>Author</dt><dd>Baptiste Pestourie </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2019 December 1st </dd></dl>

</div>
</div>
<a id="ac4d2cf5dabb492e0fd9e61db5569ed0e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac4d2cf5dabb492e0fd9e61db5569ed0e">&#9670;&nbsp;</a></span>getID() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void getID </td>
          <td>(</td>
          <td class="paramtype">byte&#160;</td>
          <td class="paramname"><em>id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Attributes an ID to the anchor. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">id</td><td>- The Id to give to the anchor </td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Baptiste Pestourie </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2019 December 1st </dd></dl>

</div>
</div>
<a id="a44620c59e3eba142cc41cb7cc8183cc4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a44620c59e3eba142cc41cb7cc8183cc4">&#9670;&nbsp;</a></span>print_byte_array()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void print_byte_array </td>
          <td>(</td>
          <td class="paramtype">byte&#160;</td>
          <td class="paramname"><em>b</em>[8]</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Displays an 8-bytes array on the serial port. </p>
<dl class="section author"><dt>Author</dt><dd>Baptiste Pestourie </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2019 December 1st </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
